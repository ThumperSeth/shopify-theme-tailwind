{{ 'template-collection.css' | asset_url | stylesheet_tag }}
{{ 'component-loading-overlay.css' | asset_url | stylesheet_tag }}
{{ 'component-card.css' | asset_url | stylesheet_tag }}
{{ 'component-price.css' | asset_url | stylesheet_tag }}
{{ 'component-product-grid.css' | asset_url | stylesheet_tag }}

<!-- DETECT MAKE & MODEL IN URL -->
{% assign url_parts = request.path | downcase | split: "/" %}
{% for part in url_parts %}
{% assign downPart = part | downcase %}
{% case downPart %}
	{% when "polaris" %}
		{% assign currentBrand  = "polaris" %}
		{% assign brandColor = "#305799" %}
		{% assign brandRGBA = "rgba(48, 87, 153, 1)" %}
		{% assign modelArray = collections.polaris.metafields.global.models | split: ',' %}
		{% break %}
	{% when "yamaha" %}
		{% assign currentBrand  = "yamaha" %}
		{% assign brandColor = "#CCCCCB" %}
		{% assign brandRGBA = "rgba(204, 204, 203, 1)" %}
		{% assign modelArray = collections.yamaha.metafields.global.models | split: ',' %}
		{% break %}
	{% when "can-am" %}
		{% assign currentBrand  = "can-am" %}
		{% assign brandColor = "#fdc832" %}
		{% assign brandRGBA = "rgba(253, 200, 50, 1)" %}
		{% assign modelArray = collections.can-am.metafields.global.models | split: ',' %}
		{% break %}
	{% when "tracker" %}
		{% assign currentBrand  = "tracker" %}
		{% assign brandColor = "#262526" %}
		{% assign brandRGBA = "rgba(38, 37, 38, 1)" %}
		{% assign modelArray = collections.tracker.metafields.global.models | split: ',' %}
		{% break %}
	{% when "honda" %}
		{% assign currentBrand  = "honda" %}
		{% assign brandColor = "#e0262f" %}
		{% assign brandRGBA = "rgba(224, 38, 47, 1)" %}
		{% assign modelArray = collections.honda.metafields.global.models | split: ',' | downcase %}
		{% break %}
	{% else %}
		{% assign currentBrand = "all" %}
		{% assign brandColor = "#ccc" %}
{% endcase %}

{% endfor %}
{% assign downURL = request.path | downcase | split: '/' %}
{% for part in downURL %}
{% for indModel in modelArray %}
	{% if indModel == part %}
		{% assign currentModel = indModel %}
	{% endif %}
{% endfor %}
{% endfor %}
<style>
  :root {
    --brand-color: {{ brandColor }};
  }
 .rating {
  display: none;
  margin: 0;
}
  .collection-card-title {
    color: #000000;
    	font-family: "Rajdhani";
      	font-weight: 700;
        letter-spacing: -0.8px;
        font-size: 1.5rem;
  }
  .collection-card-make-and-model {
    	color: #cacaca;
    	font-family: "Rajdhani";
      	font-weight: 400;
        letter-spacing: -0.8px;
        font-size: initial;
    	line-height: 1;
    	text-shadow: 2px 2px #000000;
  }
  .collection-card-price {
      	color: #000000;
    	font-family: "Rajdhani" !important;
      	font-weight: 500;
        letter-spacing: -0.8px;
        font-size: initial;
    }
</style>

<link rel="preload" href="{{ 'component-rte.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">

<noscript>{{ 'component-rte.css' | asset_url | stylesheet_tag }}</noscript>
<div>{{ currentModel }}</div>
<section id="ProductGridContainer">
	<div class="collection w-full align-center justify-items-center">
        <div class="loading-overlay gradient"></div>
      	{% paginate collections.all.products by 500 %}
        	{% assign productsArray = collections.all.products %}
      	{% endpaginate %}
      	{% assign typeArray = "accents,accessories,audio,bumpers,cages,doors,lighting,roofs,winches" | split: ',' %}
        {% for stuff in typeArray %}
              <div class="w-full grid justify-items-center" style="linear-gradient(0deg, rgba(220,220,220,1) 80%, rgb(126 145 179) 90%); {{ brandRGBA }} 100%);">
                  <div class="w-3/4 justify-items-center pb-20"> 
                      <a name="{{ stuff }}" style="scroll-behavior: smooth;">&nbsp;<br /></a>
                      <div class="text-7xl text-left text-white font-medium" style="font-family:'Teko'; text-shadow: 2px 2px #000000;">{{ stuff | upcase }}</div>
                          <ul id="product-grid"class="grid grid-cols-2 negative-margin product-grid md:grid-cols-4 lg:grid-cols-4">      
                              {% for product in productsArray %} 
                              	{% assign tempCat = product.metafields.global.category | downcase %}
                            	{% assign productMake = product.metafields.global.make | downcase %} 
                                  {% if tempCat == stuff %}
                                  	{% if productMake == currentBrand or productMake contains currentBrand %}
                            			{% if currentModel %}
                            				{% if currentModel == product.metafields.global.product_model %}
                                                <li class="grid__item w-full align-center text-left">
                                                    {% render 'collection-card',
                                                        product_card_product: product,
                                                        media_size: section.settings.image_ratio,
                                                        show_secondary_image: section.settings.show_secondary_image,
                                                        show_vendor: section.settings.show_vendor,
                                                        show_image_outline: section.settings.show_image_outline,
                                                        show_rating: false,
                                                        brand_color: brandColor
                                                    %}
                                                </li>
                            				{%- endif -%}
                            			{% else %}
                            				<li class="grid__item w-full align-center text-left">
                                                    {% render 'collection-card',
                                                        product_card_product: product,
                                                        media_size: section.settings.image_ratio,
                                                        show_secondary_image: section.settings.show_secondary_image,
                                                        show_vendor: section.settings.show_vendor,
                                                        show_image_outline: section.settings.show_image_outline,
                                                        show_rating: false,
                                                        brand_color: brandColor
                                                    %}
                                                </li>
                            			{%- endif -%}
                            		{%- endif -%}
                                  {%- endif -%}           
                              {%- endfor -%}
                          </ul>
                  </div>
              </div>
       {%- endfor -%}
  </div>
</section>

{% schema %}
{
  "name": "make-collection-grid",
  "class": "spaced-section collection-grid-section",
  "settings": [
    {
      "type": "header",
      "content": "t:sections.main-collection-product-grid.settings.header__3.content"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__1.label"
        },
        {
          "value": "portrait",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__2.label"
        },
        {
          "value": "square",
          "label": "t:sections.main-collection-product-grid.settings.image_ratio.options__3.label"
        }
      ],
      "default": "adapt",
      "label": "t:sections.main-collection-product-grid.settings.image_ratio.label"
    },
    {
      "type": "checkbox",
      "id": "show_secondary_image",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_secondary_image.label"
    },
    {
      "type": "checkbox",
      "id": "add_image_padding",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.add_image_padding.label"
    },
    {
      "type": "checkbox",
      "id": "show_image_outline",
      "default": true,
      "label": "t:sections.main-collection-product-grid.settings.show_image_outline.label"
    },
    {
      "type": "checkbox",
      "id": "show_vendor",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_vendor.label"
    },
    {
      "type": "checkbox",
      "id": "show_rating",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.show_rating.label",
      "info": "t:sections.main-collection-product-grid.settings.show_rating.info"
    },
    {
      "type": "header",
      "content": "t:sections.main-collection-product-grid.settings.header__1.content"
    },
    {
      "type": "checkbox",
      "id": "enable_filtering",
      "default": true,
      "label": "t:sections.main-collection-product-grid.settings.enable_filtering.label",
      "info": "t:sections.main-collection-product-grid.settings.enable_filtering.info"
    },
    {
      "type": "checkbox",
      "id": "enable_sorting",
      "default": true,
      "label": "t:sections.main-collection-product-grid.settings.enable_sorting.label"
    },
    {
      "type": "checkbox",
      "id": "collapse_on_larger_devices",
      "default": false,
      "label": "t:sections.main-collection-product-grid.settings.collapse_on_larger_devices.label"
    }
  ]
}
{% endschema %}
